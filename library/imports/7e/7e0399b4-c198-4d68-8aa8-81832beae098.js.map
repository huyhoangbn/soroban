{"version":3,"sources":["assets\\scripts\\miniGame\\raphael\\R.path.js"],"names":["utils","require","trasform","style","simplify","drawer","M","L","C","Z","sqrt","Math","max","abs","selectedColor","cc","color","PathDefine","Component","properties","_dirty","serializable","notify","parent","_commands","points","undefined","init","ctx","showHandles","showBoundingBox","onLoad","_gNode","Node","addComponent","Graphics","node","addChild","_applyStyle","ellipse","cx","cy","rx","ry","cmds","push","circle","r","rect","x","y","w","h","close","closed","length","clear","lastPoint","i","ii","point","makePath","path2curve","path","getPathString","commands","string","join","getTotalLength","totalLength","_analysis","getBbox","bbox","getWorldBbox","worldBbox","_transformDirty","center","position","add","v2","width","height","_curves","curves","subCurves","cmd","c","_drawCommands","t","getWorldTransform","_transformCommand","func","apply","_drawHandles","prev","size","half","originLineWidth","lineWidth","originStrokeColor","strokeColor","originFillColor","fillColor","drawHandle","x1","y1","x2","y2","moveTo","lineTo","stroke","fill","fillRect","_drawDashPath","dashArray","dashOffset","subPoints","R","drawDashPoints","update","dt","_updateAnimate","getStyledColor","Path","Class","defineClass","forEach","prototype","l","arguments"],"mappings":"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","sourceRoot":"/","sourcesContent":["'use strict';\n\nvar utils = require('./utils/R.utils');\nvar trasform = require('./component/R.transform');\nvar style = require('./component/R.style');\n// optional\nvar simplify = require('./component/optional/R.simplify');\n\nvar drawer = {\n    M: 'moveTo',\n    L: 'lineTo',\n    C: 'bezierCurveTo',\n    Z: 'close',\n};\n\nvar sqrt = Math.sqrt;\nvar max  = Math.max;\nvar abs  = Math.abs;\n\nvar selectedColor = cc.color(0,157,236);\n\n\nvar PathDefine = {\n    extends: cc.Component,\n\n    properties: {\n        _dirty: {\n            default: true,\n            serializable: false,\n            notify: function () {\n                if (this.parent && this._dirty) {\n                    this.parent._dirty = true;\n                    \n                    if (this._commands) {\n                        this._commands.points = undefined;\n                    }\n                }\n            }\n        }\n    },\n\n    init: function (parent) {\n        if (parent) {\n            this.parent = parent;\n            this.ctx = parent.ctx;\n        }\n\n        this._commands = [];\n        this._dirty = true;\n\n        this.showHandles = false;\n        this.showBoundingBox = false;\n    },\n\n    onLoad: function () {\n        this.init();\n\n        if (!this.ctx) {\n            let _gNode = new cc.Node();\n            this.ctx = _gNode.addComponent(cc.Graphics);\n            this.node.addChild(_gNode);\n\n            this._applyStyle();\n        }\n    },\n\n    ellipse: function (cx, cy, rx, ry) {\n        if (!ry) {\n            ry = rx;\n        }\n        \n        let cmds = this._commands;\n        cmds.push(['M', cx, cy]);\n        cmds.push(['m', 0, -ry]);\n        cmds.push(['a', rx, ry, 0, 1, 1, 0, 2 * ry]);\n        cmds.push(['a', rx, ry, 0, 1, 1, 0, -2 * ry]);\n        // cmds.push(['z']);\n    },\n\n    circle: function (cx, cy, r) {\n        this.ellipse(cx, cy, r);\n    },\n\n    rect: function (x, y, w, h, r) {\n        let cmds = this._commands;\n\n        if (r) {\n            cmds.push(['M', x + r, y]);\n            cmds.push(['l', w - r * 2, 0]);\n            cmds.push(['a', r, r, 0, 0, 1, r, r]);\n            cmds.push(['l', 0, h - r * 2]);\n            cmds.push(['a', r, r, 0, 0, 1, -r, r]);\n            cmds.push(['l', r * 2 - w, 0]);\n            cmds.push(['a', r, r, 0, 0, 1, -r, -r]);\n            cmds.push(['l', 0, r * 2 - h]);\n            cmds.push(['a', r, r, 0, 0, 1, r, -r]);\n        }\n        else {\n            cmds.push(['M', x, y]);\n            cmds.push(['l', w, 0]);\n            cmds.push(['l', 0, h]);\n            cmds.push(['l', -w, 0]);\n        }\n\n        cmds.push(['z']);\n    },\n\n\n   \n\n    close: function () {\n        this._commands.push(['Z']);\n    },\n\n    points: function (points, closed) {\n        if (points.length <= 1) {\n            return;\n        }\n\n        this.clear();\n\n        var lastPoint = points[0];\n        this.M(lastPoint.x, lastPoint.y);\n\n        for (var i = 1, ii = points.length; i < ii; i++) {\n            var point = points[i];\n            this.C(lastPoint.x, lastPoint.y, point.x, point.y, point.x, point.y);\n            lastPoint = point;\n        }\n\n        if (closed) {\n            this.C(lastPoint.x, lastPoint.y, points[0].x, points[0].y, points[0].x, points[0].y);\n        }\n\n        this.makePath();\n    },\n\n    makePath: function () {\n        this._commands = utils.path2curve(this._commands);\n        this._dirty = true;\n    },\n\n    path: function (path) {\n        this._commands = utils.path2curve(path);\n        this._dirty = true;\n    },\n\n    clear: function () {\n        this._commands.length = 0;\n    },\n\n    getPathString: function () {\n        var commands = this._commands;\n        var string = [];\n\n        for (var i = 0, ii = commands.length; i < ii; i++) {\n            string[i] = commands[i].join(' ');\n        }\n        string = string.join(' ');\n        return string;\n    },\n\n    getTotalLength: function () {\n        if (this._commands.totalLength === undefined) {\n            this._analysis();\n        }\n\n        return this._commands.totalLength;\n    },\n\n    getBbox: function () {\n        if (this._commands.bbox === undefined) {\n            this._analysis();\n        }\n\n        return this._commands.bbox;\n    },\n\n    getWorldBbox: function () {\n        if (this._commands.worldBbox === undefined || this._transformDirty) {\n            this._analysis();\n        }\n\n        return this._commands.worldBbox;\n    },\n\n    center: function (x, y) {\n        x = x || 0;\n        y = y || 0;\n        \n        var bbox = this.getBbox();\n        this.position = this.position.add(cc.v2(-bbox.width/2 - bbox.x + x, -bbox.height/2 - bbox.y + y));\n    },\n\n    _curves: function () {\n        var cmds = this._commands;\n        if (cmds.curves) return cmds.curves;\n\n        var curves = [];\n        var subCurves;\n        var x, y;\n\n        for (var i = 0, ii = cmds.length; i < ii; i++) {\n            var cmd = cmds[i];\n            var c = cmd[0];\n            \n            if (c === 'M') {\n                subCurves = [];\n                curves.push(subCurves);\n\n                x = cmd[1];\n                y = cmd[2];\n            }\n            else if (c === 'C' && x !== undefined && y !== undefined) {\n                subCurves.push([x, y, cmd[1], cmd[2], cmd[3], cmd[4], cmd[5], cmd[6]]);\n\n                x = cmd[5];\n                y = cmd[6];\n            }\n        }\n\n        cmds.curves = curves;\n        return curves;\n    },\n\n    _analysis: function () {\n      \n    },\n\n    //////////////////////////////////////\n    _drawCommands: function () {\n        var commands = this._commands;\n        var ctx = this.ctx;\n        var t = this.getWorldTransform();\n\n        for (var i = 0, ii = commands.length; i < ii; i++) {\n            var cmd = commands[i];\n            var c = cmd[0];\n            cmd = this._transformCommand(cmd, t);\n\n            var func = ctx[ drawer[c] ];\n\n            if (func) func.apply(ctx, cmd);\n        }\n    },\n\n    _drawHandles: function () {\n        var ctx = this.ctx;\n        var commands = this._commands;\n\n        var prev;\n        var size = 5;\n        var half = size / 2;\n\n        var originLineWidth = ctx.lineWidth;\n        var originStrokeColor = ctx.strokeColor;\n        var originFillColor   = ctx.fillColor;\n\n        ctx.lineWidth = 1;\n        ctx.strokeColor = selectedColor;\n        ctx.fillColor = selectedColor;\n\n        var t = this.getWorldTransform();\n\n        function drawHandle(x1, y1, x2, y2) {\n            ctx.moveTo(x1, y1);\n            ctx.lineTo(x2, y2);\n            ctx.stroke();\n            ctx.circle(x2, y2, half);\n            ctx.fill();\n        }\n\n        for (var i = 0, ii = commands.length; i < ii; i++) {\n            var cmd = commands[i];\n            var c = cmd[0];\n            cmd = this._transformCommand(cmd, t);\n\n            if (c === 'M') {\n                prev = cmd;\n            }\n            else if(c === 'C') {\n                drawHandle(prev[0], prev[1], cmd[0], cmd[1]);\n                drawHandle(cmd[4], cmd[5], cmd[2], cmd[3]);\n                prev = [cmd[4], cmd[5]];\n            }\n\n            if (prev)\n                ctx.fillRect(prev[0]-half, prev[1]-half, size, size);\n        }\n\n        ctx.lineWidth = originLineWidth;\n        ctx.strokeColor = originStrokeColor;\n        ctx.fillColor   = originFillColor;\n    },\n\n    _drawDashPath: function () {\n        var cmds = this._commands;\n        var ctx = this.ctx;\n        var dashArray = this.dashArray;\n        var dashOffset = this.dashOffset;\n\n        var points;\n\n        if (!cmds.points) {\n            this._analysis();\n        }\n\n        points = cmds.points;\n\n        var t = this.getWorldTransform();\n        for (var i = 0, ii = points.length; i < ii; i++) {\n            var subPoints = points[i];\n\n            R.utils.drawDashPoints(subPoints, ctx, dashArray, dashOffset, t);\n        }\n    },\n\n    //////////////////////////////////////\n    update: function (dt) {\n        if (this._updateAnimate) {\n            this._updateAnimate(dt);\n        }\n        \n        if ( this._commands.length === 0 || !this._dirty || (this.parent && !this.parent._dirty)) {\n            return;\n        }\n\n        this._applyStyle();\n\n        if (!this.parent) {\n            this.ctx.clear();\n        }\n\n        if (this.dashArray.length > 0) {\n            if (this.getStyledColor('fillColor')) {\n                this._drawCommands();\n                this.ctx.fill();\n            }\n\n            if (this.getStyledColor('strokeColor')) {\n                this._drawDashPath();\n                this.ctx.stroke();\n            }\n        }\n        else {\n            this._drawCommands();\n\n            if (this.getStyledColor('fillColor')) this.ctx.fill();\n            if (this.getStyledColor('strokeColor')) this.ctx.stroke();\n        }\n\n        if (this.showBoundingBox) {\n            var bbox = this.getWorldBbox();\n            this.ctx.rect(bbox.x, bbox.y, bbox.width, bbox.height);\n            this.ctx.stroke();\n        }\n\n        if ( this.showHandles ) this._drawHandles();\n\n        this._dirty = false;\n    }\n};\n\nvar Path = cc.Class(utils.defineClass(PathDefine,trasform,style, simplify));\n\n['M', 'm', 'L', 'l', 'H', 'h', 'V', 'v', 'C', 'c', 'S', 's', 'Q', 'q', 'T', 't', 'A', 'a', 'Z','z'].forEach(function (cmd) {\n    Path.prototype[cmd] = function () {\n        var cmds = [cmd];\n        for (var i = 0, l = arguments.length; i < l; i++) {\n            cmds[i+1] = arguments[i];\n        }\n        this._commands.push(cmds);\n    };\n});\n"]}